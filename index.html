<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="An offline, deterministic, cryptographically strong, password generator.">
    <title>Strong Pass - Secure Password and Wallet Generator</title>
    <link href="favicon.ico" rel="icon" type="image/x-icon" />
    <link rel="stylesheet" href="js/bower_components/bootstrap/dist/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="css/app.css" type="text/css">
  </head>

  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">Strong Pass</a>
        </div>
      </div>
    </nav>

    <div class="container">

      <div class="page-header">
        <h1 id="listTitleHeader">Strong Pass&nbsp;<small>deterministic, cryptographically strong, passwords and bitcoin 'brain wallets'</small></h1>
        <p class="lead">
           We all need strong passwords that are easy to remember. And by strong, I mean cryptographically strong, not a 'l33t' 'pa55w0rD'. Use this tool to generate strong passwords from a single passphrase that you can remember and attributes of the site you want to use the password on. Just type in your passphrase (we won't allow weak ones), your username or application name, and paste in the address of the site. What comes out is a strong password that you can always re-discover as long as you type in those three attributes the same next time. Use a hardware token that stores a strong extra 'salt' for extra second factor security. This site sends no information to any server. It works completely offline in your browser.
        </p>
      </div>

      <div class="form-group">
        <label>What do you want to generate?</label><br />
        <button type="button" id="webModeButton" class="modeSelector btn btn-default">Web password</button>
        <button type="button" id="appModeButton" class="modeSelector btn btn-default">Application password</button>
        <button type="button" id="btcModeButton" class="modeSelector btn btn-default">Bitcoin wallet</button>
      </div>

      <form id="inputForm" data-toggle="validator">

        <div id="keyPassphraseInputGroup" class="form-group">
          <label for="keyPassphraseInput">Passphrase <small><span class="text-muted"><a href="https://grempe.github.io/diceware/" target="_blank" tabindex="-1">Need a strong passphrase you can remember? Try a 6+ word Diceware style passphrase.</a></span></small></label>
          <input type="password" class="form-control" id="keyPassphraseInput" placeholder="a 'very strong' passphrase you can remember" minlength="11" required="required" data-error="Your passphrase is too weak. Strength meter must be in the green and say 'very strong'." autofocus="true">
          <span class="help-block with-errors"></span>
        </div>

        <div id="tokenInputGroup" class="form-group">
          <label for="tokenInput">Salt <small><span class="text-muted">optional, <a href="http://amzn.to/1Lviktk" target="_blank" tabindex="-1">Need a hardware token?</a></span></small></label>
          <input type="password" class="form-control" id="tokenInput" placeholder="">
          <span class="help-block with-errors"></span>
        </div>

        <div id="webUsernameInputGroup"class="form-group">
          <label for="webUsernameInput">Username <small><span class="text-muted">case insensitive</span></small></label>
          <input type="text" class="form-control" id="webUsernameInput" placeholder="myname@gmail.com" data-error="You must provide a login username." required="required">
          <span class="help-block with-errors"></span>
        </div>

        <div id="webDomainInputGroup" class="form-group">
          <label for="webDomainInput">URL, domain, or IP address <small><span class="text-muted">case insensitive</span></small></label>
          <input type="text" class="form-control" id="webDomainInput" placeholder="https://www.example.com/login" data-error="You must provide a URL, DNS hostname, or IP address." required="required">
          <span class="help-block with-errors"></span>
        </div>

        <div id="appNameInputGroup" class="form-group">
          <label for="appNameInput">Application name <small><span class="text-muted">case insensitive</span></small></label>
          <input type="text" class="form-control" id="appNameInput" placeholder="1password" data-error="You must provide an application name." required="required">
          <span class="help-block with-errors"></span>
        </div>

        <div id="versionInputGroup" class="form-group">
          <label for="versionInput">Version Number <small><span class="text-muted">1 - 999</span></small></label>
          <input type="number" class="form-control" id="versionInput" value="1" min="1" max="999" data-error="You must provide a version number between 1 and 999. Defaults to 1." required="required">
          <span class="help-block with-errors"></span>
        </div>

      </form>

      <div id="passwordOutputContainer" class="well">
        <p><strong>Computed Password</strong></p>
        <p><code id="passwordOutput"></code></p>
        <!-- <p><small class="text-muted"><strong>settings:</strong> <span id="sanitizedSaltInWords"></span></small></p> -->
        <p><small class="text-muted"><strong>entropy:</strong> ~<span id="passwordEntropy"></span> bits</small></p>
      </div>

      <div id="bitcoinOutputContainer" class="well">
        <p><strong>Computed Bitcoin 'Brain Wallet'</strong></p>

        <dl class="dl-horizontal">
          <dt>private key</dt>
          <dd><span id="bitcoinPrivateKey"></span></dd>
          <dt>private key (<a href="https://en.bitcoin.it/wiki/Wallet_import_format" target="_blank">WIF</a>)</dt>
          <dd><span id="bitcoinPrivateKeyWIF"></span></dd>
          <dt>public key</dt>
          <dd><span id="bitcoinPublicKey"></span></dd>
          <dt>address</dt>
          <dd><span id="bitcoinAddress"></span></dd>
          <dt>address QR code</dt>
          <dd>
            <br />
            <div id="qrcode"></div>
            <small id="qrcodeAddress"></small>
          </dd>
        </dl>

      </div>

      <hr />

      <br />

      <h2 class="text-muted">Frequently Asked Questions</h2>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">What does it do?</h3>
        </div>
        <div class="panel-body">
          <p>This application generates strong passwords by combining a strong passphrase, a username or application name, a version number, a DNS hostname plus optional extra 'salt' from a hardware token like the <a href="http://amzn.to/1Lviktk" target="_blank">Yubikey Neo</a>. Hardware token salt adds a form of second factor (something you have) to the passphrase (something you know). Your passphrase, and the optional salt, must be kept private and never used elsewhere. The username/application name and URI are assumed public. A cryptographic key derivation function (scrypt) is used to derive the password from the attributes you provide. The same attributes will always result in the same password. It is not possible to reverse the process and find your passphrase or salt from a stolen site password.</p>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">What do you mean by 'deterministic'?</h3>
        </div>
        <div class="panel-body">
          <blockquote>
            <p>In computer science, a deterministic algorithm is an algorithm which, given a particular input, will always produce the same output, with the underlying machine always passing through the same sequence of states. Deterministic algorithms are by far the most studied and familiar kind of algorithm, as well as one of the most practical, since they can be run on real machines efficiently.</p>
            <p>Formally, a deterministic algorithm computes a mathematical function; a function has a unique value for any input in its domain, and the algorithm is a process that produces this particular value as output.</p>
            <footer>Deterministic algorithm <cite title="Wikipedia"><a href="https://en.wikipedia.org/wiki/Deterministic_algorithm" target="_blank">Wikipedia</a></cite></footer>
          </blockquote>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">What do you mean by 'cryptographically strong'?</h3>
        </div>
        <div class="panel-body">
          <blockquote>
            <p>In computer science, a deterministic algorithm is an algorithm which, given a particular input, will always produce the same output, with the underlying machine always passing through the same sequence of states. Deterministic algorithms are by far the most studied and familiar kind of algorithm, as well as one of the most practical, since they can be run on real machines efficiently.</p>
            <p>Formally, a deterministic algorithm computes a mathematical function; a function has a unique value for any input in its domain, and the algorithm is a process that produces this particular value as output.</p>
            <footer>Deterministic algorithm <cite title="Wikipedia"><a href="https://en.wikipedia.org/wiki/Deterministic_algorithm" target="_blank">Wikipedia</a></cite></footer>
          </blockquote>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Is it safe?</h3>
        </div>
        <div class="panel-body">
          <p>I created this tool for my own use. I use it. You can trust it to do what it says. It will generate strong passwords locally in your browser and will never communicate anything that you enter, or the passwords it generates, out to the Internet. You are free to browse the <a href="https://github.com/grempe/strongpass" target="_blank">source code</a>, and you can easily run a local copy by just opening the <code>index.html</code> file in your browser. In this case you can run this site completely offline, with your network disconnected. There are no cookies, no analytics tracking scripts, and it runs only over a TLS (HTTPS) connection.</p>
          <p>All that being said, I am not a cryptographer, and this code has not been reviewed in any serious way by cryptographers. I believe it is strong based on the fact that I am using published crypto primatives consistent with their recommended usage based on my own research. There is no cryptographic invention claimed. Read the source code and decide for yourself if its safe for you.</p>
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">What is the algorithm used to generate passwords?</h3>
        </div>
        <div class="panel-body">
          <p>Here is a pseudocode version of the algorithm. Leading and trailing whitespace is stripped from all input fields. You can view the full source code <a href="https://github.com/grempe/strongpass/blob/master/js/main.js" target="_blank">here</a>.</p>

          <pre class="pre-scrollable">
masterKey         = hmacSha512(passphrase, sha512(downcase(usernameOrAppname)))
salt              = sha512(downcase(usernameOrAppname) + downcase(hostname) + version + tokenSalt)
derivedKey        = scrypt(masterKey, salt, 16384, 8, 1, 64 Bytes Output)
derivedKeyFirst32 = derivedKey[0, 32]
derivedKeyLast32  = derivedKey[32, 64]
symbol            = lookupSymbol(derivedKeyFirst32[31] % 10)
number            = lookupNumber(derivedKeyFirst32[30] % 10)
password          = first18Chars(base64encode(derivedKeyFirst32)) + symbol + number
bitcoinKeypair    = generateKeypairFromKey(hex(derivedKeyLast32))
          </pre>
        </div>
      </div>

    </div><!-- /.container -->

    <!-- load third party libraries -->
    <script src="js/bower_components/jquery/dist/jquery.min.js"></script>
    <script src="js/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="js/bower_components/pwstrength-bootstrap/dist/pwstrength-bootstrap-1.2.7.min.js"></script>
    <script src="js/bower_components/bootstrap-validator/dist/validator.min.js"></script>
    <script src="js/bower_components/jsuri/Uri.js"></script>
    <script src="js/bower_components/zxcvbn/zxcvbn.js"></script>
    <script src="js/bower_components/tweetnacl/nacl-fast.min.js"></script>
    <script src="js/bower_components/tweetnacl-auth/nacl-auth.min.js"></script>
    <script src="js/bower_components/js-scrypt/browser/scrypt.js"></script>
    <script src="js/bower_components/bitcore/bitcore.min.js"></script>
    <script src="js/bower_components/jquery-qrcode/jquery.qrcode.min.js"></script>

    <!-- core application JS -->
    <script src="js/main.js"></script>

  </body>

</html>
